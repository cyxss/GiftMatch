<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>å›ºå®šç§å­éšæœºé…å¯¹ï¼ˆä»…æœ¬äººå¯æŸ¥ï¼‰</title>
  <style>
    :root{ --brand:#4F46E5; --ok:#059669; --err:#DC2626; }
    *{ box-sizing: border-box; }
    body{ margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Apple Color Emoji,Noto Color Emoji,Arial,Helvetica,sans-serif; background:#f6f7fb; color:#1f2937; }
    .wrap{ max-width:880px; margin:32px auto; padding:24px; background:#fff; border-radius:14px; box-shadow:0 10px 30px rgba(0,0,0,.08); }
    h1{ margin:0 0 10px; font-size:22px; color:var(--brand); }
    p{ margin:8px 0; color:#4b5563; }
    code{ background:#f0f2f7; padding:2px 6px; border-radius:6px; }
    .grid{ display:grid; grid-template-columns: 1fr auto; gap:10px; margin-top:16px; }
    input[type="text"]{ width:100%; padding:12px 14px; border:1px solid #e5e7eb; border-radius:10px; font-size:15px; outline:none; }
    input[type="text"]:focus{ border-color:#c7d2fe; box-shadow:0 0 0 4px rgba(79,70,229,.12); }
    button{ border:0; background:var(--brand); color:#fff; font-weight:700; padding:12px 16px; border-radius:10px; cursor:pointer; }
    button.secondary{ background:#eef2ff; color:#3730a3; }
    button.ghost{ background:#fff; color:#4f46e5; border:1px solid #c7d2fe; }
    .hint{ font-size:13px; color:#6b7280; }
    .msg{ margin-top:14px; font-weight:700; }
    .msg.ok{ color:var(--ok); }
    .msg.err{ color:var(--err); }
    details{ margin-top:18px; background:#fafafa; border:1px solid #eee; border-radius:10px; padding:12px; }
    table{ width:100%; border-collapse:collapse; margin-top:8px; }
    th,td{ padding:10px; border-bottom:1px solid #f0f2f7; text-align:left; }
    th{ background:#fbfbfe; }
    .note{ font-size:13px; color:#6b7280; margin-top:10px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>å›ºå®šç§å­éšæœºé…å¯¹ï¼ˆä¸åŒ¹é…è‡ªå·±ï¼‰</h1>

    <hr style="border:none;border-top:1px solid #eee; margin:14px 0 8px;" />

    <div>
      <label for="nameInput" class="hint">åœ¨ä¸‹æ–¹è¾“å…¥ä½ çš„åå­—ï¼ˆéœ€æ˜¯sp, wg, cj, yx, yf, xgä¸­çš„ä¸€ä¸ªï¼Œå¤§å°å†™ä¸æ•æ„Ÿï¼‰</label>
      <div class="grid">
        <input id="nameInput" type="text" placeholder="ä¾‹å¦‚ï¼šCJ" />
        <button id="btnLookup">æŸ¥çœ‹æˆ‘çš„é…å¯¹</button>
      </div>
      <p id="msg" class="msg hint"></p>
    </div>


  </div>

  <script>
    // ===================== å¯é…ç½®åŒº =====================
    // é¢„å…ˆè®¾ç½®çš„ 6 ä¸ªäººåï¼ˆå¤§å°å†™ä¸æ•æ„Ÿï¼›å±•ç¤ºæ—¶ä¿ç•™åŸæ ·ï¼‰ã€‚
    // ğŸ‘‰ åœ¨æ­£å¼ä½¿ç”¨å‰ï¼ŒæŠŠä¸‹é¢æ•°ç»„æ›¿æ¢ä¸ºä½ çš„ 6 ä¸ªåå­—ï¼ˆå¿…é¡»äº’ä¸ç›¸åŒï¼‰ã€‚
    const NAMES = [
      'SP',
      'WG',
      'CJ',
      'YX',
      'YF',
      'XG'
    ];

    // å›ºå®šéšæœºç§å­ï¼ˆä¿æŒä¸å˜å³å¯ä¿è¯å…¨å¹³å°ä¸€è‡´ï¼‰ã€‚å¯ä»¥å†™ä»»ä½•å­—ç¬¦ä¸²ã€‚
    const SEED_STR = '2025-09-22-Seed-v1';
    // =================== é…ç½®åŒºç»“æŸ =====================

    // ---- å·¥å…·ï¼šå¤§å°å†™ä¸æ•æ„ŸåŒ¹é… ----
    const lowerSet = new Map(NAMES.map(n => [n.toLowerCase(), n]));

    // ---- ç§å­éšæœºï¼šxmur3 + mulberry32 ----
    // xmur3 äº§ç”Ÿä¸€ä¸ª 32-bit æ•£åˆ—å¹¶è¿”å›ç§å­ç”Ÿæˆå™¨
    function xmur3(str){
      let h = 1779033703 ^ str.length;
      for (let i=0; i<str.length; i++){
        h = Math.imul(h ^ str.charCodeAt(i), 3432918353);
        h = (h << 13) | (h >>> 19);
      }
      return function(){
        h = Math.imul(h ^ (h >>> 16), 2246822507);
        h = Math.imul(h ^ (h >>> 13), 3266489909);
        return (h ^= h >>> 16) >>> 0;
      }
    }
    // mulberry32ï¼šç®€å•å¿«é€Ÿçš„ 32 ä½ PRNG
    function mulberry32(a){
      return function(){
        let t = (a += 0x6D2B79F5) >>> 0;
        t = Math.imul(t ^ (t >>> 15), t | 1);
        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      }
    }

    // ç»™å®šå­—ç¬¦ä¸²ç§å­ -> ç”Ÿæˆ [0,1) éšæœºæ•°å‡½æ•°
    function seededRNG(seedStr){
      const seedGen = xmur3(seedStr);
      // ç»„åˆå‡ ä¸ªç§å­å€¼ä»¥å‡å°‘ç¢°æ’
      const a = seedGen();
      const b = seedGen();
      const c = seedGen();
      const d = seedGen();
      // åˆæˆä¸€ä¸ªæ–°æ•´æ•°ç§å­ï¼ˆä¹Ÿå¯åªç”¨ aï¼‰
      const mix = (a ^ (b<<5)) ^ (c>>>3) ^ d;
      return mulberry32(mix >>> 0);
    }

    // ---- Sattolo å•å¾ªç¯æ‰“ä¹±ï¼ˆä¿è¯æ— å›ºå®šç‚¹ï¼‰----
    function sattoloShuffleSeeded(array, rng){
      // åŸåœ°æ‰“ä¹±ï¼Œç”Ÿæˆå•åœˆç½®æ¢ï¼šå¯¹äº n>1ï¼Œä¸ä¼šå‡ºç° fixed point
      for (let i = array.length - 1; i > 0; i--){
        // å…³é”®ï¼šj âˆˆ [0, i-1]
        const j = Math.floor(rng() * i); // 0..i-1
        const tmp = array[i];
        array[i] = array[j];
        array[j] = tmp;
      }
      return array;
    }

    // ---- ç”Ÿæˆå›ºå®šæ˜ å°„ï¼ˆé€ç¤¼äºº -> è¢«æŠ½ä¸­ï¼‰----
    function buildPairs(names, seedStr){
      if (names.length !== 6) throw new Error('å¿…é¡»æ°å¥½ 6 ä¸ªäººã€‚');
      // åŸºæœ¬æ ¡éªŒï¼šå”¯ä¸€æ€§
      const uniq = new Set(names.map(n => n.toLowerCase()));
      if (uniq.size !== names.length) throw new Error('åå­—å¿…é¡»äº’ä¸ç›¸åŒã€‚');

      const givers = names.slice();
      const receivers = names.slice();
      const rng = seededRNG(seedStr);
      if (receivers.length < 2) throw new Error('äººæ•°ä¸è¶³ä»¥é”™æ’ã€‚');
      sattoloShuffleSeeded(receivers, rng);

      // å®‰å…¨æ–­è¨€ï¼šä¸åº”å‡ºç°å›ºå®šç‚¹
      for (let i=0;i<givers.length;i++){
        if (givers[i] === receivers[i]){
          // ç†è®ºä¸Šä¸ä¼šè§¦å‘ï¼›å¦‚è§¦å‘ï¼Œåšä¸€æ¬¡ç›¸é‚»äº¤æ¢
          const k = (i+1) % receivers.length;
          const t = receivers[i]; receivers[i]=receivers[k]; receivers[k]=t;
        }
      }
      // è¾“å‡ºæ˜ å°„
      const map = new Map();
      for (let i=0;i<givers.length;i++) map.set(givers[i], receivers[i]);
      return map;
    }

    // è®¡ç®—ä¸€æ¬¡å…¨å±€å›ºå®šæ˜ å°„ï¼ˆè·¨è®¾å¤‡ä¸€è‡´ï¼‰
    const PAIR_MAP = buildPairs(NAMES, SEED_STR);

    // ---- UIï¼šä¸ªäººæŸ¥è¯¢ ----
    const $input = document.getElementById('nameInput');
    const $btn = document.getElementById('btnLookup');
    const $msg = document.getElementById('msg');

    function showMsg(text, cls){
      $msg.className = 'msg ' + (cls||'');
      $msg.textContent = text;
    }

    function onLookup(){
      const raw = ($input.value || '').trim();
      if (!raw){ showMsg('è¯·è¾“å…¥ä½ çš„åå­—ã€‚','err'); return; }
      const keyLower = raw.toLowerCase();
      if (!lowerSet.has(keyLower)){
        showMsg('æœªåœ¨åå•ä¸­æ‰¾åˆ°è¯¥åå­—ï¼Œè¯·ä¸ç»„ç»‡è€…ç¡®è®¤ä¹¦å†™æ˜¯å¦ä¸€è‡´ã€‚','err');
        return;
      }
      const canonical = lowerSet.get(keyLower); // åŸæ ·å±•ç¤º
      const target = PAIR_MAP.get(canonical);
      if (!target){
        showMsg('å†…éƒ¨é”™è¯¯ï¼šæœªæ‰¾åˆ°é…å¯¹ã€‚','err');
        return;
      }
      showMsg(`ä½ æŠ½åˆ°çš„äººæ˜¯ï¼š${target}`,'ok');
    }

    $btn.addEventListener('click', onLookup);
    $input.addEventListener('keydown', (e)=>{ if (e.key === 'Enter') onLookup(); });

    // ---- éªŒè¯/å±•ç¤ºå·¥å…·ï¼ˆå¼€å‘ç”¨ï¼‰----
    const $reveal = document.getElementById('btnReveal');
    const $pairsBody = document.getElementById('pairsBody');
    const $tableWrap = document.getElementById('tableWrap');

    $reveal.addEventListener('click', ()=>{
      $pairsBody.innerHTML = '';
      let i=0;
      for (const giver of NAMES){
        const tr = document.createElement('tr');
        const rec = PAIR_MAP.get(giver);
        tr.innerHTML = `<td>${++i}</td><td>${escapeHtml(giver)}</td><td>${escapeHtml(rec)}</td>`;
        $pairsBody.appendChild(tr);
      }
      $tableWrap.style.display = 'block';
    });

    function escapeHtml(s){
      return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[c]));
    }
  </script>
</body>
</html>